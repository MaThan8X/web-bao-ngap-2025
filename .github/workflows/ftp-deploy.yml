# ftp-deploy.yml (Ver 02 - Dự án Web Báo Ngập 2025)
# - Thay thế logic lftp thủ công bằng cách sử dụng đúng action SamKirkland/FTP-Deploy-Action.
# - Đảm bảo toàn bộ nội dung repository (gồm send-data.php, index.html, v.v...) được triển khai.
# pass chuẩn
name: Deploy to FTP Host
# Kích hoạt khi có code được đẩy lên nhánh 'main'
on:
  push:
    branches:
      - main

jobs:
  ftp-deploy:
    name: FTP Deploy
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        # Lấy mã nguồn từ repo
        uses: actions/checkout@v4

      - name: Deploy via SamKirkland FTP Action
        # Sử dụng action đã chọn, action này sẽ tự động deploy toàn bộ file
        uses: SamKirkland/FTP-Deploy-Action@v4.3.4
        with:
          server: ${{ secrets.FTP_HOST }}
          username: ${{ secrets.FTP_USERNAME }}
          password: ${{ secrets.FTP_PASSWORD }}
          # Đường dẫn đến thư mục dự án mới trên hosting (bao-ngap-2025/)
          remote-path: ${{ secrets.FTP_REMOTE_PATH }}
          # Mặc định là . (thư mục gốc của repo)
          # local-path: '.' 
          # Mặc định là false. Đặt true để chỉ upload file đã thay đổi (nên dùng)
          state-name: .ftp-deploy-state.json
